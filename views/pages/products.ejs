<!DOCTYPE html>
<html lang="en">
  <head>
    <%- include('../partials/head'); -%>
  </head>
  <body>
    <%- include('../partials/nav'); -%>
    <div class="brandinfo">
      <div class="container">
        <div class="brandinfo__container">
          <nav>
            <ul class="breadcrumb">
              <li class="breadcrumb-items">
                <a href="home">Home</a>
              </li>
              <span>&ThickSpace;&#62;&ThickSpace;</span>
              <li class="breadcrumb-item active"><%= title %></li>
            </ul>
          </nav>
        </div>
        <div class="brandinfo_container">
          <% if(title == "vans" || title == "converse" || title == "palladium") {%>
            <div class='brandinfo__img-<%= title %>'>
              <img src='/images/<%= title %>-logo.png' />
            </div>
          <% }  %> 

          <div class="brandinfo__filter">
            <div class="brandinfo__filter-label">Sort by</div>
            <button class="brandinfo__filter-btn">Popular</button>
            <button class="brandinfo__filter-btn">Newest</button>
            <button class="brandinfo__filter-btn">Most favorite</button>
            <div class="brandinfo__filter-selection-container">
              <div class="brandinfo__filter-selection">Price</div>
              <i
                class="brandinfo__filter-selection__icon fas fa-angle-down"
              ></i>
              <ul class="brandinfo__filter-selection-container__option">
                <li class="brandinfo__filter__option__item">
                  <a class="brandinfo__select-input" href="#">Lowest</a>
                </li>
                <li class="brandinfo__filter__option__item">
                  <a class="brandinfo__select-input" href="#">Highest</a>
                </li>
              </ul>
            </div>
            <div class="brandinfo__filter-searchcontainer">
             <form action="/products/searchProducts" method="GET">
               <input name="q" type="text" placeholder="Search">
               <div class="brandinfo__filter-searchcontainer-btn">
                 <button>Search</button>
          </div>
          </form>
        </div>
      </div>
          </div>
        </div>
        <div class="brandinfo__float">
          <div class="brandinfo__tag-container">
            <div class="brandinfo__tag-size">SIZE:</div>
            <div class="brandinfo__tag">
              <p>39</p>
              <p>40</p>
              <p>41</p>
            </div>
            <div class="brandinfo__tag-size">COLOR:</div>
            <div class="brandinfo__tag">
              <p><i class="fa fa-star" aria-hidden="true"></i></p>
              <p>WHITE</p>
              <p>YELLOW</p>
            </div>
            <div class="brandinfo__tag-size">STYLES:</div>
            <div class="brandinfo__tag">
              <p>OLD SKOOL</p>
              <p>SLIP ON</p>
              <p>ORIGINAL CLASSIC</p>
            </div>
          </div>

          <div class="brandinfo__product">
            <div class="brandinfo__product-container">
              <div class="product">
                <div class="row d-flex"> 
                  <% if (product == null) {%>
                      <div> not found</div>
                       <% } else {%>
                  <% product.forEach(product => { %>
                  <div  class="product__item">
                    <% if (product.condition) { %>
                      <span class="product__new">NEW</span>
                    <% } %>
    
                    <% if (product.sale > 0) { %>
                      <span class="product__sale"><%= product.sale%>%</span>
                    <% } %>
    
                    <a class="product__image">
                      <img src="<%= product.coverImagePath %>" alt="productImage" class="img-fluid" />
                    </a>
                    <div class="product__summary">
                      <div class="product__info">
                        <p class="brandinfo__product"><%= product.name %></p>
                        <p class="product__price"></p>
                      </div>
                      <div class="product__action">
                        <span class="product__add">ADD TO CART</span>
                        <div class="product__action--right">
                          <a href="product/<%= product.slug %>" class="product__view"
                            ><i class="far fa-eye product__icon"></i
                          ></a>
                          <span class="product__love"
                            ><i class="far fa-heart product__icon"></i
                          ></span>
                        </div>
                      </div>
                    </div>
                  </div>
                  <% }) %>
                  <% } %>
                </div>
              </div>
            </div>
            <div class="brandinfo__paginationcontainer">
              <div class="pagination">
                <% if (pages > 0) { %>
                  <ul class="pagination text-center">
                    <!-- disable First button when current is 1 -->
                      <% if (current == 1) { %>
                          <li class="disabled-link"><a>First</a></li>
                      <% } else { %>
                        <% if (searchQuery) { %>
                          <li><a href="/products?search=<%= searchQuery %>&page=1">First</a></li>
                        <% } else { %>
                          <li><a href="/products?page=1">First</a></li>
                        <% } %>
                      <% } %>

                      <!-- determine the start of pagination -->
                      <% if (Number(current) <= 2) {
                            i = 1;
                          } else if (Number(current) > pages - 2) {
                            i = pages - 4;
                          } else {
                            i = Number(current) - 2;
                          }
                          
                          start = i;
                      %>

                      <!-- loop through  -->
                      <% for (; i < start + 5 && i <= pages; i++) { %>
                          <!-- if i == current => active current link -->
                          <% if (i == current) { %>
                            <li class="active"><a><%= i %></a></li>
                          
                          <!-- otherwise display links -->
                          <% } else { %>
                            <% if (searchQuery) { %>
                              <li><a href="/products?search=<%= searchQuery %>&page=<%= i %>"><%= i %></a></li>
                            <% } else { %>
                              <li><a href="/products?page=<%= i %>"><%= i %></a></li>
                            <% } %>
                          <% } %>
                      <% } %>
                    
                      <!-- disable Last button when current page is equal number of pages -->
                      <% if (current == pages) { %>
                          <li class="disabled-link"><a>Last</a></li>
                      <% } else { %>
                        <% if (searchQuery) { %>
                          <li><a href="/products?search=<%= searchQuery %>&page=<%= pages %>">Last</a></li>
                        <% } else { %>
                          <li><a href="/products?page=<%= pages %>">Last</a></li>
                        <% } %>
                      <% } %>
                  </ul>
              <% } %>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <%- include('../partials/footer'); -%> <%-
    include('../partials/script-line'); -%>
  </body>
</html>
